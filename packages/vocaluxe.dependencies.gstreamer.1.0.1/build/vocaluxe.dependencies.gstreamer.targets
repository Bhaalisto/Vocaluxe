<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.5" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <UsingTask TaskName="lukeIam.msbuild.tasks.ZipDownload.ZipDownloadTask"  AssemblyFile="$(MSBuildThisFileDirectory)..\tools\lukeIam.msbuild.tasks.ZipDownload.dll" />
    
    <Target Name="gstreamerBeforeBuild" BeforeTargets="BeforeBuild">   
        <PropertyGroup>
            <ZipAdress Condition="'$(Platform)'=='x64'">https://github.com/lukeIam/VocaluxeDependencies/blob/master/zips/dependencies/gstreamer_x64.zip?raw=true</ZipAdress>
            <ZipAdress Condition="'$(Platform)'=='x86'">https://github.com/lukeIam/VocaluxeDependencies/blob/master/zips/dependencies/gstreamer_x86.zip?raw=true</ZipAdress>
            <TargetFolder Condition="'$(Platform)'=='x64'">$(TargetDir)libs\unmanaged\gstreamer64\</TargetFolder>
            <TargetFolder Condition="'$(Platform)'=='x86'">$(TargetDir)libs\unmanaged\gstreamer86\</TargetFolder>
            <GstreamerPath Condition="'$(Platform)'=='x64'">$(GSTREAMER_1_0_ROOT_X86_64)</GstreamerPath>
            <GstreamerPath Condition="'$(Platform)'=='x86'">$(GSTREAMER_1_0_ROOT_X86)</GstreamerPath>
        </PropertyGroup>
        
        <Message Text="gstreamer exists locally" Importance="normal" Condition="Exists('$(TargetFolder)')" />
        <Message Text="gstreamer exists globally" Importance="normal" Condition="Exists('$(GstreamerPath)')" />        
        <Message Text="gstreamer is missing - download started:" Importance="normal" Condition="!Exists('$(TargetFolder)') AND !Exists('$(GstreamerPath)')"/>
  
        <Message Text='$(ZipAdress)' Importance="normal" Condition="!Exists('$(TargetFolder)') AND !Exists('$(GstreamerPath)')"/>
        <ZipDownloadTask Address='$(ZipAdress)' TargetFolder='$(TargetFolder)' Condition="!Exists('$(TargetFolder)') AND !Exists('$(GstreamerPath)')"/>
    </Target>
</Project>